2025-09-17 15:21:12,217 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for data files: {'../trail_trekker.db'} (connection.py:491)
2025-09-17 15:21:12,446 - MainThread - sqlmesh.core.config.connection - INFO - Using existing DuckDB adapter due to overlapping data file: ../trail_trekker.db (connection.py:481)
2025-09-17 15:21:12,580 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage PhysicalLayerSchemaCreationStage (evaluator.py:123)
2025-09-17 15:21:12,581 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'sqlmesh__default' (evaluator.py:1374)
2025-09-17 15:21:12,581 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 287e365c922645a2a5750fdf03790fb3 */ CREATE SCHEMA IF NOT EXISTS "sqlmesh__default" (base.py:2498)
2025-09-17 15:21:12,581 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage PhysicalLayerUpdateStage (evaluator.py:123)
2025-09-17 15:21:12,582 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema sqlmesh__default (evaluator.py:1477)
2025-09-17 15:21:12,582 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 287e365c922645a2a5750fdf03790fb3 */ SELECT CURRENT_CATALOG() (base.py:2498)
2025-09-17 15:21:12,583 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 287e365c922645a2a5750fdf03790fb3 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'trail_trekker' AND table_schema = 'sqlmesh__default') AND table_name IN ('staging_plans__223612256', 'raw_plan_features__32802264', 'raw_subscriptions__1243030195', 'raw_customers__3189645474', 'staging_subscriptions__3522423559', 'fct_subscription_changes__2124406755', 'raw_features__8593745', 'staging_features__2301256321', 'staging_customers__3937340300', 'raw_plans__3266981680') (base.py:2498)
2025-09-17 15:21:12,589 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage BackfillStage (evaluator.py:123)
2025-09-17 15:21:12,589 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage EnvironmentRecordUpdateStage (evaluator.py:123)
2025-09-17 15:21:12,589 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Promoting environment 'prod' (facade.py:166)
2025-09-17 15:21:12,595 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage UnpauseStage (evaluator.py:123)
2025-09-17 15:21:12,597 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage VirtualLayerUpdateStage (evaluator.py:123)
2025-09-17 15:21:12,598 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'default' (evaluator.py:1374)
2025-09-17 15:21:12,598 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 287e365c922645a2a5750fdf03790fb3 */ CREATE SCHEMA IF NOT EXISTS "default" (base.py:2498)
2025-09-17 15:21:12,599 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'default.fct_subscription_changes' to point at table 'sqlmesh__default.fct_subscription_changes__2124406755' (evaluator.py:1746)
2025-09-17 15:21:12,599 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 287e365c922645a2a5750fdf03790fb3 */ SELECT CURRENT_CATALOG() (base.py:2498)
2025-09-17 15:21:12,599 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 287e365c922645a2a5750fdf03790fb3 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'trail_trekker' AND table_schema = 'default') AND table_name IN ('fct_subscription_changes') (base.py:2498)
2025-09-17 15:21:12,601 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 287e365c922645a2a5750fdf03790fb3 */ CREATE OR REPLACE VIEW "default"."fct_subscription_changes" AS SELECT * FROM "sqlmesh__default"."fct_subscription_changes__2124406755" (base.py:2498)
2025-09-17 15:21:12,602 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 287e365c922645a2a5750fdf03790fb3 */ COMMENT ON COLUMN "default"."fct_subscription_changes"."plan_name" IS 'Plan details' (base.py:2498)
2025-09-17 15:21:12,602 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 287e365c922645a2a5750fdf03790fb3 */ COMMENT ON COLUMN "default"."fct_subscription_changes"."subscription_duration_days" IS 'Calculated metrics' (base.py:2498)
2025-09-17 15:21:12,602 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 287e365c922645a2a5750fdf03790fb3 */ COMMENT ON COLUMN "default"."fct_subscription_changes"."total_subscription_value" IS 'Revenue calculation' (base.py:2498)
2025-09-17 15:21:12,603 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage FinalizeEnvironmentStage (evaluator.py:123)
2025-09-17 15:21:12,603 - MainThread - sqlmesh.core.state_sync.db.environment - INFO - Finalizing environment 'prod' (environment.py:141)
2025-09-17 15:21:12,613 - MainThread - root - INFO - Shutting down the event dispatcher (dispatcher.py:159)
