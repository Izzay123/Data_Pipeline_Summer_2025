2025-09-04 12:46:46,338 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for data files: {'../trail_trekker.db'} (connection.py:489)
2025-09-04 12:46:46,366 - MainThread - sqlmesh.core.config.connection - INFO - Using existing DuckDB adapter due to overlapping data file: ../trail_trekker.db (connection.py:479)
2025-09-04 12:46:46,369 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Compacting 0 intervals for 0 snapshots (interval.py:129)
2025-09-04 12:46:46,370 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Compacting 0 intervals for 0 snapshots (interval.py:129)
2025-09-04 12:46:46,429 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema sqlmesh__default (evaluator.py:444)
2025-09-04 12:46:46,429 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:2452)
2025-09-04 12:46:46,430 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'trail_trekker' AND table_schema = 'sqlmesh__default') AND table_name IN ('staging_plans__223612256', 'staging_features__2301256321', 'staging_customers__3937340300', 'staging_subscriptions__3522423559') (base.py:2452)
2025-09-04 12:46:46,438 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"staging_customers": 1336970724> (evaluator.py:727)
2025-09-04 12:46:46,438 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting data for snapshot SnapshotId<"staging_customers": 1336970724> (evaluator.py:916)
2025-09-04 12:46:46,442 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2025-09-03 00:00:00, 2025-09-04 00:00:00) into sqlmesh__default.staging_customers__3937340300' (evaluator.py:947)
2025-09-04 12:46:46,442 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Replacing view 'sqlmesh__default.staging_customers__3937340300' (evaluator.py:2313)
2025-09-04 12:46:46,442 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:2452)
2025-09-04 12:46:46,443 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'trail_trekker' AND table_schema = 'sqlmesh__default') AND table_name IN ('staging_customers__3937340300') (base.py:2452)
2025-09-04 12:46:46,445 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW "sqlmesh__default"."staging_customers__3937340300" ("customer_id", "username", "email", "phone", "first_name", "last_name", "date_of_birth", "preferred_difficulty", "location_city", "location_state", "location_country", "profile_created_date", "total_hikes_logged", "favorite_trail_type") AS SELECT "raw_customers"."customer_id" AS "customer_id", "raw_customers"."username" AS "username", "raw_customers"."email" AS "email", COALESCE("raw_customers"."phone", '000-0000') AS "phone", "raw_customers"."first_name" AS "first_name", "raw_customers"."last_name" AS "last_name", COALESCE(TRY_CAST("raw_customers"."date_of_birth" AS DATE), CAST('1900-01-01' AS DATE)) AS "date_of_birth", "raw_customers"."preferred_difficulty" AS "preferred_difficulty", "raw_customers"."location_city" AS "location_city", "raw_customers"."location_state" AS "location_state", "raw_customers"."location_country" AS "location_country", COALESCE(TRY_CAST("raw_customers"."profile_created_date" AS DATE), CAST('1900-01-01' AS DATE)) AS "profile_created_date", COALESCE(TRY_CAST("raw_customers"."total_hikes_logged" AS INT), 0) AS "total_hikes_logged", "raw_customers"."favorite_trail_type" AS "favorite_trail_type" FROM "sqlmesh__default"."raw_customers__3189645474" AS "raw_customers" (base.py:2452)
2025-09-04 12:46:46,445 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Auditing snapshot SnapshotId<"staging_customers": 1336970724> (evaluator.py:619)
2025-09-04 12:46:46,446 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DESCRIBE "sqlmesh__default"."staging_customers__3937340300" (base.py:2452)
2025-09-04 12:46:46,448 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT COUNT(*) FROM (SELECT * FROM "trail_trekker"."sqlmesh__default"."staging_customers__3937340300" AS "staging_customers__3937340300" WHERE "customer_id" IS NULL AND TRUE) AS "audit" (base.py:2452)
2025-09-04 12:46:46,449 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Adding interval (2025-09-03 00:00:00, 2025-09-04 00:00:00) for snapshot SnapshotId<"staging_customers": 1336970724> (facade.py:619)
2025-09-04 12:46:46,449 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"staging_customers": 1336970724> (interval.py:214)
2025-09-04 12:46:46,455 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"staging_features": 2445522912> (evaluator.py:727)
2025-09-04 12:46:46,455 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting data for snapshot SnapshotId<"staging_features": 2445522912> (evaluator.py:916)
2025-09-04 12:46:46,456 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2025-09-03 00:00:00, 2025-09-04 00:00:00) into sqlmesh__default.staging_features__2301256321' (evaluator.py:947)
2025-09-04 12:46:46,456 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Replacing view 'sqlmesh__default.staging_features__2301256321' (evaluator.py:2313)
2025-09-04 12:46:46,456 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:2452)
2025-09-04 12:46:46,457 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'trail_trekker' AND table_schema = 'sqlmesh__default') AND table_name IN ('staging_features__2301256321') (base.py:2452)
2025-09-04 12:46:46,459 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW "sqlmesh__default"."staging_features__2301256321" ("feature_id", "feature_name", "feature_description", "feature_category") AS SELECT "raw_features"."feature_id" AS "feature_id", "raw_features"."feature_name" AS "feature_name", "raw_features"."feature_description" AS "feature_description", "raw_features"."feature_category" AS "feature_category" FROM "sqlmesh__default"."raw_features__8593745" AS "raw_features" (base.py:2452)
2025-09-04 12:46:46,459 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Auditing snapshot SnapshotId<"staging_features": 2445522912> (evaluator.py:619)
2025-09-04 12:46:46,459 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DESCRIBE "sqlmesh__default"."staging_features__2301256321" (base.py:2452)
2025-09-04 12:46:46,461 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT COUNT(*) FROM (SELECT * FROM "trail_trekker"."sqlmesh__default"."staging_features__2301256321" AS "staging_features__2301256321" WHERE "feature_id" IS NULL AND TRUE) AS "audit" (base.py:2452)
2025-09-04 12:46:46,461 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Adding interval (2025-09-03 00:00:00, 2025-09-04 00:00:00) for snapshot SnapshotId<"staging_features": 2445522912> (facade.py:619)
2025-09-04 12:46:46,461 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"staging_features": 2445522912> (interval.py:214)
2025-09-04 12:46:46,466 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"staging_plans": 15186778> (evaluator.py:727)
2025-09-04 12:46:46,466 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting data for snapshot SnapshotId<"staging_plans": 15186778> (evaluator.py:916)
2025-09-04 12:46:46,469 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2025-09-03 00:00:00, 2025-09-04 00:00:00) into sqlmesh__default.staging_plans__223612256' (evaluator.py:947)
2025-09-04 12:46:46,469 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Replacing view 'sqlmesh__default.staging_plans__223612256' (evaluator.py:2313)
2025-09-04 12:46:46,469 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:2452)
2025-09-04 12:46:46,469 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'trail_trekker' AND table_schema = 'sqlmesh__default') AND table_name IN ('staging_plans__223612256') (base.py:2452)
2025-09-04 12:46:46,471 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW "sqlmesh__default"."staging_plans__223612256" ("plan_id", "plan_name", "plan_level", "price", "max_hikes_per_month", "photo_storage_gb", "description", "created_at") AS SELECT "raw_plans"."plan_id" AS "plan_id", "raw_plans"."plan_name" AS "plan_name", COALESCE(TRY_CAST("raw_plans"."plan_level" AS INT), 0) AS "plan_level", COALESCE(TRY_CAST("raw_plans"."price" AS DOUBLE), 0.0) AS "price", COALESCE(TRY_CAST("raw_plans"."max_hikes_per_month" AS INT), 0) AS "max_hikes_per_month", COALESCE(TRY_CAST("raw_plans"."photo_storage_gb" AS INT), 0) AS "photo_storage_gb", "raw_plans"."description" AS "description", COALESCE(TRY_CAST("raw_plans"."created_at" AS DATE), CAST('1900-01-01' AS DATE)) AS "created_at" FROM "sqlmesh__default"."raw_plans__3266981680" AS "raw_plans" (base.py:2452)
2025-09-04 12:46:46,472 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Adding interval (2025-09-03 00:00:00, 2025-09-04 00:00:00) for snapshot SnapshotId<"staging_plans": 15186778> (facade.py:619)
2025-09-04 12:46:46,472 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"staging_plans": 15186778> (interval.py:214)
2025-09-04 12:46:46,476 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"staging_subscriptions": 2513094209> (evaluator.py:727)
2025-09-04 12:46:46,476 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting data for snapshot SnapshotId<"staging_subscriptions": 2513094209> (evaluator.py:916)
2025-09-04 12:46:46,479 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2025-09-03 00:00:00, 2025-09-04 00:00:00) into sqlmesh__default.staging_subscriptions__3522423559' (evaluator.py:947)
2025-09-04 12:46:46,479 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Replacing view 'sqlmesh__default.staging_subscriptions__3522423559' (evaluator.py:2313)
2025-09-04 12:46:46,480 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:2452)
2025-09-04 12:46:46,480 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'trail_trekker' AND table_schema = 'sqlmesh__default') AND table_name IN ('staging_subscriptions__3522423559') (base.py:2452)
2025-09-04 12:46:46,482 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW "sqlmesh__default"."staging_subscriptions__3522423559" ("subscription_id", "customer_id", "plan_id", "billing_cycle", "subscription_start_date", "subscription_end_date", "status", "next_billing_date", "payment_method") AS SELECT "raw_subscriptions"."subscription_id" AS "subscription_id", "raw_subscriptions"."customer_id" AS "customer_id", "raw_subscriptions"."plan_id" AS "plan_id", "raw_subscriptions"."billing_cycle" AS "billing_cycle", "raw_subscriptions"."subscription_start_date" AS "subscription_start_date", COALESCE(TRY_CAST("raw_subscriptions"."subscription_end_date" AS DATE), CAST('1900-01-01' AS DATE)) AS "subscription_end_date", "raw_subscriptions"."status" AS "status", COALESCE(TRY_CAST("raw_subscriptions"."next_billing_date" AS DATE), CAST('1900-01-01' AS DATE)) AS "next_billing_date", "raw_subscriptions"."payment_method" AS "payment_method" FROM "sqlmesh__default"."raw_subscriptions__1243030195" AS "raw_subscriptions" (base.py:2452)
2025-09-04 12:46:46,482 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Auditing snapshot SnapshotId<"staging_subscriptions": 2513094209> (evaluator.py:619)
2025-09-04 12:46:46,482 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DESCRIBE "sqlmesh__default"."staging_subscriptions__3522423559" (base.py:2452)
2025-09-04 12:46:46,485 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT COUNT(*) FROM (SELECT * FROM "trail_trekker"."sqlmesh__default"."staging_subscriptions__3522423559" AS "staging_subscriptions__3522423559" WHERE ("subscription_id" IS NULL OR "customer_id" IS NULL OR "plan_id" IS NULL) AND TRUE) AS "audit" (base.py:2452)
2025-09-04 12:46:46,485 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Adding interval (2025-09-03 00:00:00, 2025-09-04 00:00:00) for snapshot SnapshotId<"staging_subscriptions": 2513094209> (facade.py:619)
2025-09-04 12:46:46,485 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"staging_subscriptions": 2513094209> (interval.py:214)
2025-09-04 12:46:46,497 - MainThread - root - INFO - Shutting down the event dispatcher (dispatcher.py:159)
