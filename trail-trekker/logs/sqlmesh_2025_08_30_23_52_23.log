2025-08-30 23:52:23,382 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for data files: {'../trail_trekker.db'} (connection.py:489)
2025-08-30 23:52:23,640 - MainThread - sqlmesh.core.config.connection - INFO - Using existing DuckDB adapter due to overlapping data file: ../trail_trekker.db (connection.py:479)
2025-08-30 23:52:29,259 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage CreateSnapshotRecordsStage (evaluator.py:125)
2025-08-30 23:52:29,274 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage PhysicalLayerSchemaCreationStage (evaluator.py:125)
2025-08-30 23:52:29,275 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'sqlmesh__default' (evaluator.py:1378)
2025-08-30 23:52:29,275 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b151e521f16f4114b73e8488aae0e012 */ CREATE SCHEMA IF NOT EXISTS "sqlmesh__default" (base.py:2452)
2025-08-30 23:52:29,275 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage BackfillStage (evaluator.py:125)
2025-08-30 23:52:29,300 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema sqlmesh__default (evaluator.py:444)
2025-08-30 23:52:29,300 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b151e521f16f4114b73e8488aae0e012 */ SELECT CURRENT_CATALOG() (base.py:2452)
2025-08-30 23:52:29,301 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b151e521f16f4114b73e8488aae0e012 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'trail_trekker' AND table_schema = 'sqlmesh__default') AND table_name IN ('staging_features__2301256321', 'staging_plans__223612256', 'raw_subscriptions__1243030195', 'staging_customers__3937340300', 'raw_plans__3266981680', 'staging_subscriptions__3522423559', 'raw_features__8593745', 'raw_customers__3189645474') (base.py:2452)
2025-08-30 23:52:29,309 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"staging_customers": 4168624899> (evaluator.py:727)
2025-08-30 23:52:29,309 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b151e521f16f4114b73e8488aae0e012 */ DESCRIBE "sqlmesh__default"."staging_customers__3937340300" (base.py:2452)
2025-08-30 23:52:29,312 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating view 'sqlmesh__default.staging_customers__3937340300' (evaluator.py:2349)
2025-08-30 23:52:29,317 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b151e521f16f4114b73e8488aae0e012 */ CREATE VIEW "sqlmesh__default"."staging_customers__3937340300" AS SELECT "raw_customers"."customer_id" AS "customer_id", "raw_customers"."username" AS "username", "raw_customers"."email" AS "email", COALESCE("raw_customers"."phone", '000-0000') AS "phone", "raw_customers"."first_name" AS "first_name", "raw_customers"."last_name" AS "last_name", COALESCE(TRY_CAST("raw_customers"."date_of_birth" AS DATE), CAST('1900-01-01' AS DATE)) AS "date_of_birth", "raw_customers"."preferred_difficulty" AS "preferred_difficulty", "raw_customers"."location_city" AS "location_city", "raw_customers"."location_state" AS "location_state", "raw_customers"."location_country" AS "location_country", COALESCE(TRY_CAST("raw_customers"."profile_created_date" AS DATE), CAST('1900-01-01' AS DATE)) AS "profile_created_date", COALESCE(TRY_CAST("raw_customers"."total_hikes_logged" AS INT), 0) AS "total_hikes_logged", "raw_customers"."favorite_trail_type" AS "favorite_trail_type" FROM "sqlmesh__default"."raw_customers__3189645474" AS "raw_customers" (base.py:2452)
2025-08-30 23:52:29,317 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting data for snapshot SnapshotId<"staging_customers": 4168624899> (evaluator.py:916)
2025-08-30 23:52:29,321 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2025-08-30 00:00:00, 2025-08-31 00:00:00) into sqlmesh__default.staging_customers__3937340300' (evaluator.py:947)
2025-08-30 23:52:29,321 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Replacing view 'sqlmesh__default.staging_customers__3937340300' (evaluator.py:2313)
2025-08-30 23:52:29,321 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b151e521f16f4114b73e8488aae0e012 */ SELECT CURRENT_CATALOG() (base.py:2452)
2025-08-30 23:52:29,321 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b151e521f16f4114b73e8488aae0e012 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'trail_trekker' AND table_schema = 'sqlmesh__default') AND table_name IN ('staging_customers__3937340300') (base.py:2452)
2025-08-30 23:52:29,323 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b151e521f16f4114b73e8488aae0e012 */ CREATE OR REPLACE VIEW "sqlmesh__default"."staging_customers__3937340300" ("customer_id", "username", "email", "phone", "first_name", "last_name", "date_of_birth", "preferred_difficulty", "location_city", "location_state", "location_country", "profile_created_date", "total_hikes_logged", "favorite_trail_type") AS SELECT "raw_customers"."customer_id" AS "customer_id", "raw_customers"."username" AS "username", "raw_customers"."email" AS "email", COALESCE("raw_customers"."phone", '000-0000') AS "phone", "raw_customers"."first_name" AS "first_name", "raw_customers"."last_name" AS "last_name", COALESCE(TRY_CAST("raw_customers"."date_of_birth" AS DATE), CAST('1900-01-01' AS DATE)) AS "date_of_birth", "raw_customers"."preferred_difficulty" AS "preferred_difficulty", "raw_customers"."location_city" AS "location_city", "raw_customers"."location_state" AS "location_state", "raw_customers"."location_country" AS "location_country", COALESCE(TRY_CAST("raw_customers"."profile_created_date" AS DATE), CAST('1900-01-01' AS DATE)) AS "profile_created_date", COALESCE(TRY_CAST("raw_customers"."total_hikes_logged" AS INT), 0) AS "total_hikes_logged", "raw_customers"."favorite_trail_type" AS "favorite_trail_type" FROM "sqlmesh__default"."raw_customers__3189645474" AS "raw_customers" (base.py:2452)
2025-08-30 23:52:29,324 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Adding interval (2025-08-30 00:00:00, 2025-08-31 00:00:00) for snapshot SnapshotId<"staging_customers": 4168624899> (facade.py:619)
2025-08-30 23:52:29,324 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"staging_customers": 4168624899> (interval.py:214)
2025-08-30 23:52:29,328 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"staging_features": 2445522912> (evaluator.py:727)
2025-08-30 23:52:29,329 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b151e521f16f4114b73e8488aae0e012 */ DESCRIBE "sqlmesh__default"."staging_features__2301256321" (base.py:2452)
2025-08-30 23:52:29,329 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating view 'sqlmesh__default.staging_features__2301256321' (evaluator.py:2349)
2025-08-30 23:52:29,330 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b151e521f16f4114b73e8488aae0e012 */ CREATE VIEW "sqlmesh__default"."staging_features__2301256321" AS SELECT "raw_features"."feature_id" AS "feature_id", "raw_features"."feature_name" AS "feature_name", "raw_features"."feature_description" AS "feature_description", "raw_features"."feature_category" AS "feature_category" FROM "sqlmesh__default"."raw_features__8593745" AS "raw_features" (base.py:2452)
2025-08-30 23:52:29,330 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting data for snapshot SnapshotId<"staging_features": 2445522912> (evaluator.py:916)
2025-08-30 23:52:29,332 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2025-08-30 00:00:00, 2025-08-31 00:00:00) into sqlmesh__default.staging_features__2301256321' (evaluator.py:947)
2025-08-30 23:52:29,332 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Replacing view 'sqlmesh__default.staging_features__2301256321' (evaluator.py:2313)
2025-08-30 23:52:29,332 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b151e521f16f4114b73e8488aae0e012 */ SELECT CURRENT_CATALOG() (base.py:2452)
2025-08-30 23:52:29,333 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b151e521f16f4114b73e8488aae0e012 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'trail_trekker' AND table_schema = 'sqlmesh__default') AND table_name IN ('staging_features__2301256321') (base.py:2452)
2025-08-30 23:52:29,334 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b151e521f16f4114b73e8488aae0e012 */ CREATE OR REPLACE VIEW "sqlmesh__default"."staging_features__2301256321" ("feature_id", "feature_name", "feature_description", "feature_category") AS SELECT "raw_features"."feature_id" AS "feature_id", "raw_features"."feature_name" AS "feature_name", "raw_features"."feature_description" AS "feature_description", "raw_features"."feature_category" AS "feature_category" FROM "sqlmesh__default"."raw_features__8593745" AS "raw_features" (base.py:2452)
2025-08-30 23:52:29,334 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Auditing snapshot SnapshotId<"staging_features": 2445522912> (evaluator.py:619)
2025-08-30 23:52:29,334 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b151e521f16f4114b73e8488aae0e012 */ DESCRIBE "sqlmesh__default"."staging_features__2301256321" (base.py:2452)
2025-08-30 23:52:29,337 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b151e521f16f4114b73e8488aae0e012 */ SELECT COUNT(*) FROM (SELECT * FROM "trail_trekker"."sqlmesh__default"."staging_features__2301256321" AS "staging_features__2301256321" WHERE "feature_id" IS NULL AND TRUE) AS "audit" (base.py:2452)
2025-08-30 23:52:29,337 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Adding interval (2025-08-30 00:00:00, 2025-08-31 00:00:00) for snapshot SnapshotId<"staging_features": 2445522912> (facade.py:619)
2025-08-30 23:52:29,337 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"staging_features": 2445522912> (interval.py:214)
2025-08-30 23:52:29,342 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"staging_plans": 15186778> (evaluator.py:727)
2025-08-30 23:52:29,343 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b151e521f16f4114b73e8488aae0e012 */ DESCRIBE "sqlmesh__default"."staging_plans__223612256" (base.py:2452)
2025-08-30 23:52:29,343 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating view 'sqlmesh__default.staging_plans__223612256' (evaluator.py:2349)
2025-08-30 23:52:29,346 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b151e521f16f4114b73e8488aae0e012 */ CREATE VIEW "sqlmesh__default"."staging_plans__223612256" AS SELECT "raw_plans"."plan_id" AS "plan_id", "raw_plans"."plan_name" AS "plan_name", COALESCE(TRY_CAST("raw_plans"."plan_level" AS INT), 0) AS "plan_level", COALESCE(TRY_CAST("raw_plans"."price" AS DOUBLE), 0.0) AS "price", COALESCE(TRY_CAST("raw_plans"."max_hikes_per_month" AS INT), 0) AS "max_hikes_per_month", COALESCE(TRY_CAST("raw_plans"."photo_storage_gb" AS INT), 0) AS "photo_storage_gb", "raw_plans"."description" AS "description", COALESCE(TRY_CAST("raw_plans"."created_at" AS DATE), CAST('1900-01-01' AS DATE)) AS "created_at" FROM "sqlmesh__default"."raw_plans__3266981680" AS "raw_plans" (base.py:2452)
2025-08-30 23:52:29,347 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting data for snapshot SnapshotId<"staging_plans": 15186778> (evaluator.py:916)
2025-08-30 23:52:29,349 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2025-08-30 00:00:00, 2025-08-31 00:00:00) into sqlmesh__default.staging_plans__223612256' (evaluator.py:947)
2025-08-30 23:52:29,349 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Replacing view 'sqlmesh__default.staging_plans__223612256' (evaluator.py:2313)
2025-08-30 23:52:29,349 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b151e521f16f4114b73e8488aae0e012 */ SELECT CURRENT_CATALOG() (base.py:2452)
2025-08-30 23:52:29,350 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b151e521f16f4114b73e8488aae0e012 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'trail_trekker' AND table_schema = 'sqlmesh__default') AND table_name IN ('staging_plans__223612256') (base.py:2452)
2025-08-30 23:52:29,352 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b151e521f16f4114b73e8488aae0e012 */ CREATE OR REPLACE VIEW "sqlmesh__default"."staging_plans__223612256" ("plan_id", "plan_name", "plan_level", "price", "max_hikes_per_month", "photo_storage_gb", "description", "created_at") AS SELECT "raw_plans"."plan_id" AS "plan_id", "raw_plans"."plan_name" AS "plan_name", COALESCE(TRY_CAST("raw_plans"."plan_level" AS INT), 0) AS "plan_level", COALESCE(TRY_CAST("raw_plans"."price" AS DOUBLE), 0.0) AS "price", COALESCE(TRY_CAST("raw_plans"."max_hikes_per_month" AS INT), 0) AS "max_hikes_per_month", COALESCE(TRY_CAST("raw_plans"."photo_storage_gb" AS INT), 0) AS "photo_storage_gb", "raw_plans"."description" AS "description", COALESCE(TRY_CAST("raw_plans"."created_at" AS DATE), CAST('1900-01-01' AS DATE)) AS "created_at" FROM "sqlmesh__default"."raw_plans__3266981680" AS "raw_plans" (base.py:2452)
2025-08-30 23:52:29,353 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Adding interval (2025-08-30 00:00:00, 2025-08-31 00:00:00) for snapshot SnapshotId<"staging_plans": 15186778> (facade.py:619)
2025-08-30 23:52:29,353 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"staging_plans": 15186778> (interval.py:214)
2025-08-30 23:52:29,356 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"staging_subscriptions": 2513094209> (evaluator.py:727)
2025-08-30 23:52:29,357 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b151e521f16f4114b73e8488aae0e012 */ DESCRIBE "sqlmesh__default"."staging_subscriptions__3522423559" (base.py:2452)
2025-08-30 23:52:29,357 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating view 'sqlmesh__default.staging_subscriptions__3522423559' (evaluator.py:2349)
2025-08-30 23:52:29,360 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b151e521f16f4114b73e8488aae0e012 */ CREATE VIEW "sqlmesh__default"."staging_subscriptions__3522423559" AS SELECT "raw_subscriptions"."subscription_id" AS "subscription_id", "raw_subscriptions"."customer_id" AS "customer_id", "raw_subscriptions"."plan_id" AS "plan_id", "raw_subscriptions"."billing_cycle" AS "billing_cycle", "raw_subscriptions"."subscription_start_date" AS "subscription_start_date", COALESCE(TRY_CAST("raw_subscriptions"."subscription_end_date" AS DATE), CAST('1900-01-01' AS DATE)) AS "subscription_end_date", "raw_subscriptions"."status" AS "status", COALESCE(TRY_CAST("raw_subscriptions"."next_billing_date" AS DATE), CAST('1900-01-01' AS DATE)) AS "next_billing_date", "raw_subscriptions"."payment_method" AS "payment_method" FROM "sqlmesh__default"."raw_subscriptions__1243030195" AS "raw_subscriptions" (base.py:2452)
2025-08-30 23:52:29,360 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting data for snapshot SnapshotId<"staging_subscriptions": 2513094209> (evaluator.py:916)
2025-08-30 23:52:29,362 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2025-08-30 00:00:00, 2025-08-31 00:00:00) into sqlmesh__default.staging_subscriptions__3522423559' (evaluator.py:947)
2025-08-30 23:52:29,362 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Replacing view 'sqlmesh__default.staging_subscriptions__3522423559' (evaluator.py:2313)
2025-08-30 23:52:29,362 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b151e521f16f4114b73e8488aae0e012 */ SELECT CURRENT_CATALOG() (base.py:2452)
2025-08-30 23:52:29,363 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b151e521f16f4114b73e8488aae0e012 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'trail_trekker' AND table_schema = 'sqlmesh__default') AND table_name IN ('staging_subscriptions__3522423559') (base.py:2452)
2025-08-30 23:52:29,365 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b151e521f16f4114b73e8488aae0e012 */ CREATE OR REPLACE VIEW "sqlmesh__default"."staging_subscriptions__3522423559" ("subscription_id", "customer_id", "plan_id", "billing_cycle", "subscription_start_date", "subscription_end_date", "status", "next_billing_date", "payment_method") AS SELECT "raw_subscriptions"."subscription_id" AS "subscription_id", "raw_subscriptions"."customer_id" AS "customer_id", "raw_subscriptions"."plan_id" AS "plan_id", "raw_subscriptions"."billing_cycle" AS "billing_cycle", "raw_subscriptions"."subscription_start_date" AS "subscription_start_date", COALESCE(TRY_CAST("raw_subscriptions"."subscription_end_date" AS DATE), CAST('1900-01-01' AS DATE)) AS "subscription_end_date", "raw_subscriptions"."status" AS "status", COALESCE(TRY_CAST("raw_subscriptions"."next_billing_date" AS DATE), CAST('1900-01-01' AS DATE)) AS "next_billing_date", "raw_subscriptions"."payment_method" AS "payment_method" FROM "sqlmesh__default"."raw_subscriptions__1243030195" AS "raw_subscriptions" (base.py:2452)
2025-08-30 23:52:29,365 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Auditing snapshot SnapshotId<"staging_subscriptions": 2513094209> (evaluator.py:619)
2025-08-30 23:52:29,365 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b151e521f16f4114b73e8488aae0e012 */ DESCRIBE "sqlmesh__default"."staging_subscriptions__3522423559" (base.py:2452)
2025-08-30 23:52:29,369 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b151e521f16f4114b73e8488aae0e012 */ SELECT COUNT(*) FROM (SELECT * FROM "trail_trekker"."sqlmesh__default"."staging_subscriptions__3522423559" AS "staging_subscriptions__3522423559" WHERE ("subscription_id" IS NULL OR "customer_id" IS NULL OR "plan_id" IS NULL) AND TRUE) AS "audit" (base.py:2452)
2025-08-30 23:52:29,369 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Adding interval (2025-08-30 00:00:00, 2025-08-31 00:00:00) for snapshot SnapshotId<"staging_subscriptions": 2513094209> (facade.py:619)
2025-08-30 23:52:29,369 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"staging_subscriptions": 2513094209> (interval.py:214)
2025-08-30 23:52:29,374 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage EnvironmentRecordUpdateStage (evaluator.py:125)
2025-08-30 23:52:29,374 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Promoting environment 'dev' (facade.py:167)
2025-08-30 23:52:29,380 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage VirtualLayerUpdateStage (evaluator.py:125)
2025-08-30 23:52:29,382 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'default__dev' (evaluator.py:1378)
2025-08-30 23:52:29,382 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b151e521f16f4114b73e8488aae0e012 */ CREATE SCHEMA IF NOT EXISTS "default__dev" (base.py:2452)
2025-08-30 23:52:29,382 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'default__dev.raw_customers' to point at table 'sqlmesh__default.raw_customers__3189645474' (evaluator.py:1694)
2025-08-30 23:52:29,382 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b151e521f16f4114b73e8488aae0e012 */ SELECT CURRENT_CATALOG() (base.py:2452)
2025-08-30 23:52:29,383 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b151e521f16f4114b73e8488aae0e012 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'trail_trekker' AND table_schema = 'default__dev') AND table_name IN ('raw_customers') (base.py:2452)
2025-08-30 23:52:29,384 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b151e521f16f4114b73e8488aae0e012 */ CREATE OR REPLACE VIEW "default__dev"."raw_customers" AS SELECT * FROM "sqlmesh__default"."raw_customers__3189645474" (base.py:2452)
2025-08-30 23:52:29,385 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'default__dev.raw_features' to point at table 'sqlmesh__default.raw_features__8593745' (evaluator.py:1694)
2025-08-30 23:52:29,385 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b151e521f16f4114b73e8488aae0e012 */ SELECT CURRENT_CATALOG() (base.py:2452)
2025-08-30 23:52:29,386 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b151e521f16f4114b73e8488aae0e012 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'trail_trekker' AND table_schema = 'default__dev') AND table_name IN ('raw_features') (base.py:2452)
2025-08-30 23:52:29,388 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b151e521f16f4114b73e8488aae0e012 */ CREATE OR REPLACE VIEW "default__dev"."raw_features" AS SELECT * FROM "sqlmesh__default"."raw_features__8593745" (base.py:2452)
2025-08-30 23:52:29,389 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'default__dev.raw_plan_features' to point at table 'sqlmesh__default.raw_plan_features__32802264' (evaluator.py:1694)
2025-08-30 23:52:29,389 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b151e521f16f4114b73e8488aae0e012 */ SELECT CURRENT_CATALOG() (base.py:2452)
2025-08-30 23:52:29,389 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b151e521f16f4114b73e8488aae0e012 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'trail_trekker' AND table_schema = 'default__dev') AND table_name IN ('raw_plan_features') (base.py:2452)
2025-08-30 23:52:29,391 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b151e521f16f4114b73e8488aae0e012 */ CREATE OR REPLACE VIEW "default__dev"."raw_plan_features" AS SELECT * FROM "sqlmesh__default"."raw_plan_features__32802264" (base.py:2452)
2025-08-30 23:52:29,392 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'default__dev.raw_plans' to point at table 'sqlmesh__default.raw_plans__3266981680' (evaluator.py:1694)
2025-08-30 23:52:29,392 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b151e521f16f4114b73e8488aae0e012 */ SELECT CURRENT_CATALOG() (base.py:2452)
2025-08-30 23:52:29,392 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b151e521f16f4114b73e8488aae0e012 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'trail_trekker' AND table_schema = 'default__dev') AND table_name IN ('raw_plans') (base.py:2452)
2025-08-30 23:52:29,393 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b151e521f16f4114b73e8488aae0e012 */ CREATE OR REPLACE VIEW "default__dev"."raw_plans" AS SELECT * FROM "sqlmesh__default"."raw_plans__3266981680" (base.py:2452)
2025-08-30 23:52:29,394 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'default__dev.raw_subscriptions' to point at table 'sqlmesh__default.raw_subscriptions__1243030195' (evaluator.py:1694)
2025-08-30 23:52:29,395 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b151e521f16f4114b73e8488aae0e012 */ SELECT CURRENT_CATALOG() (base.py:2452)
2025-08-30 23:52:29,395 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b151e521f16f4114b73e8488aae0e012 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'trail_trekker' AND table_schema = 'default__dev') AND table_name IN ('raw_subscriptions') (base.py:2452)
2025-08-30 23:52:29,396 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b151e521f16f4114b73e8488aae0e012 */ CREATE OR REPLACE VIEW "default__dev"."raw_subscriptions" AS SELECT * FROM "sqlmesh__default"."raw_subscriptions__1243030195" (base.py:2452)
2025-08-30 23:52:29,397 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'default__dev.staging_customers' to point at table 'sqlmesh__default.staging_customers__3937340300' (evaluator.py:1694)
2025-08-30 23:52:29,397 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b151e521f16f4114b73e8488aae0e012 */ SELECT CURRENT_CATALOG() (base.py:2452)
2025-08-30 23:52:29,398 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b151e521f16f4114b73e8488aae0e012 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'trail_trekker' AND table_schema = 'default__dev') AND table_name IN ('staging_customers') (base.py:2452)
2025-08-30 23:52:29,399 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b151e521f16f4114b73e8488aae0e012 */ CREATE OR REPLACE VIEW "default__dev"."staging_customers" AS SELECT * FROM "sqlmesh__default"."staging_customers__3937340300" (base.py:2452)
2025-08-30 23:52:29,400 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'default__dev.staging_features' to point at table 'sqlmesh__default.staging_features__2301256321' (evaluator.py:1694)
2025-08-30 23:52:29,400 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b151e521f16f4114b73e8488aae0e012 */ SELECT CURRENT_CATALOG() (base.py:2452)
2025-08-30 23:52:29,401 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b151e521f16f4114b73e8488aae0e012 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'trail_trekker' AND table_schema = 'default__dev') AND table_name IN ('staging_features') (base.py:2452)
2025-08-30 23:52:29,402 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b151e521f16f4114b73e8488aae0e012 */ CREATE OR REPLACE VIEW "default__dev"."staging_features" AS SELECT * FROM "sqlmesh__default"."staging_features__2301256321" (base.py:2452)
2025-08-30 23:52:29,403 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'default__dev.staging_plans' to point at table 'sqlmesh__default.staging_plans__223612256' (evaluator.py:1694)
2025-08-30 23:52:29,404 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b151e521f16f4114b73e8488aae0e012 */ SELECT CURRENT_CATALOG() (base.py:2452)
2025-08-30 23:52:29,404 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b151e521f16f4114b73e8488aae0e012 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'trail_trekker' AND table_schema = 'default__dev') AND table_name IN ('staging_plans') (base.py:2452)
2025-08-30 23:52:29,406 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b151e521f16f4114b73e8488aae0e012 */ CREATE OR REPLACE VIEW "default__dev"."staging_plans" AS SELECT * FROM "sqlmesh__default"."staging_plans__223612256" (base.py:2452)
2025-08-30 23:52:29,406 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'default__dev.staging_subscriptions' to point at table 'sqlmesh__default.staging_subscriptions__3522423559' (evaluator.py:1694)
2025-08-30 23:52:29,407 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b151e521f16f4114b73e8488aae0e012 */ SELECT CURRENT_CATALOG() (base.py:2452)
2025-08-30 23:52:29,407 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b151e521f16f4114b73e8488aae0e012 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'trail_trekker' AND table_schema = 'default__dev') AND table_name IN ('staging_subscriptions') (base.py:2452)
2025-08-30 23:52:29,408 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b151e521f16f4114b73e8488aae0e012 */ CREATE OR REPLACE VIEW "default__dev"."staging_subscriptions" AS SELECT * FROM "sqlmesh__default"."staging_subscriptions__3522423559" (base.py:2452)
2025-08-30 23:52:29,410 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage FinalizeEnvironmentStage (evaluator.py:125)
2025-08-30 23:52:29,410 - MainThread - sqlmesh.core.state_sync.db.environment - INFO - Finalizing environment 'dev' (environment.py:141)
2025-08-30 23:52:29,422 - MainThread - root - INFO - Shutting down the event dispatcher (dispatcher.py:159)
