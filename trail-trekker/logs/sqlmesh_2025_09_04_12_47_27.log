2025-09-04 12:47:27,984 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for data files: {'../trail_trekker.db'} (connection.py:489)
2025-09-04 12:47:28,248 - MainThread - sqlmesh.core.config.connection - INFO - Using existing DuckDB adapter due to overlapping data file: ../trail_trekker.db (connection.py:479)
2025-09-04 12:47:30,076 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage PhysicalLayerSchemaCreationStage (evaluator.py:125)
2025-09-04 12:47:30,078 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'sqlmesh__default' (evaluator.py:1378)
2025-09-04 12:47:30,078 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b415d42ba91b43bd9bda68f5dfc53920 */ CREATE SCHEMA IF NOT EXISTS "sqlmesh__default" (base.py:2452)
2025-09-04 12:47:30,078 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage PhysicalLayerUpdateStage (evaluator.py:125)
2025-09-04 12:47:30,080 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema sqlmesh__default (evaluator.py:444)
2025-09-04 12:47:30,080 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b415d42ba91b43bd9bda68f5dfc53920 */ SELECT CURRENT_CATALOG() (base.py:2452)
2025-09-04 12:47:30,081 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b415d42ba91b43bd9bda68f5dfc53920 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'trail_trekker' AND table_schema = 'sqlmesh__default') AND table_name IN ('staging_subscriptions__3522423559', 'staging_customers__3937340300', 'raw_plan_features__32802264', 'raw_customers__3189645474', 'raw_subscriptions__1243030195', 'raw_plans__3266981680', 'raw_features__8593745', 'staging_features__2301256321', 'staging_plans__223612256', 'fct_subscription_changes__2613690352') (base.py:2452)
2025-09-04 12:47:30,093 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage BackfillStage (evaluator.py:125)
2025-09-04 12:47:30,093 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage EnvironmentRecordUpdateStage (evaluator.py:125)
2025-09-04 12:47:30,093 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Promoting environment 'dev' (facade.py:167)
2025-09-04 12:47:30,102 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage VirtualLayerUpdateStage (evaluator.py:125)
2025-09-04 12:47:30,105 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'default__dev' (evaluator.py:1378)
2025-09-04 12:47:30,105 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b415d42ba91b43bd9bda68f5dfc53920 */ CREATE SCHEMA IF NOT EXISTS "default__dev" (base.py:2452)
2025-09-04 12:47:30,105 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'default__dev.raw_customers' to point at table 'sqlmesh__default.raw_customers__3189645474' (evaluator.py:1694)
2025-09-04 12:47:30,105 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b415d42ba91b43bd9bda68f5dfc53920 */ SELECT CURRENT_CATALOG() (base.py:2452)
2025-09-04 12:47:30,106 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b415d42ba91b43bd9bda68f5dfc53920 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'trail_trekker' AND table_schema = 'default__dev') AND table_name IN ('raw_customers') (base.py:2452)
2025-09-04 12:47:30,108 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b415d42ba91b43bd9bda68f5dfc53920 */ CREATE OR REPLACE VIEW "default__dev"."raw_customers" AS SELECT * FROM "sqlmesh__default"."raw_customers__3189645474" (base.py:2452)
2025-09-04 12:47:30,109 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'default__dev.raw_features' to point at table 'sqlmesh__default.raw_features__8593745' (evaluator.py:1694)
2025-09-04 12:47:30,109 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b415d42ba91b43bd9bda68f5dfc53920 */ SELECT CURRENT_CATALOG() (base.py:2452)
2025-09-04 12:47:30,110 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b415d42ba91b43bd9bda68f5dfc53920 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'trail_trekker' AND table_schema = 'default__dev') AND table_name IN ('raw_features') (base.py:2452)
2025-09-04 12:47:30,112 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b415d42ba91b43bd9bda68f5dfc53920 */ CREATE OR REPLACE VIEW "default__dev"."raw_features" AS SELECT * FROM "sqlmesh__default"."raw_features__8593745" (base.py:2452)
2025-09-04 12:47:30,113 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'default__dev.raw_plan_features' to point at table 'sqlmesh__default.raw_plan_features__32802264' (evaluator.py:1694)
2025-09-04 12:47:30,113 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b415d42ba91b43bd9bda68f5dfc53920 */ SELECT CURRENT_CATALOG() (base.py:2452)
2025-09-04 12:47:30,113 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b415d42ba91b43bd9bda68f5dfc53920 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'trail_trekker' AND table_schema = 'default__dev') AND table_name IN ('raw_plan_features') (base.py:2452)
2025-09-04 12:47:30,115 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b415d42ba91b43bd9bda68f5dfc53920 */ CREATE OR REPLACE VIEW "default__dev"."raw_plan_features" AS SELECT * FROM "sqlmesh__default"."raw_plan_features__32802264" (base.py:2452)
2025-09-04 12:47:30,116 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'default__dev.raw_plans' to point at table 'sqlmesh__default.raw_plans__3266981680' (evaluator.py:1694)
2025-09-04 12:47:30,116 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b415d42ba91b43bd9bda68f5dfc53920 */ SELECT CURRENT_CATALOG() (base.py:2452)
2025-09-04 12:47:30,117 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b415d42ba91b43bd9bda68f5dfc53920 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'trail_trekker' AND table_schema = 'default__dev') AND table_name IN ('raw_plans') (base.py:2452)
2025-09-04 12:47:30,118 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b415d42ba91b43bd9bda68f5dfc53920 */ CREATE OR REPLACE VIEW "default__dev"."raw_plans" AS SELECT * FROM "sqlmesh__default"."raw_plans__3266981680" (base.py:2452)
2025-09-04 12:47:30,119 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'default__dev.raw_subscriptions' to point at table 'sqlmesh__default.raw_subscriptions__1243030195' (evaluator.py:1694)
2025-09-04 12:47:30,119 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b415d42ba91b43bd9bda68f5dfc53920 */ SELECT CURRENT_CATALOG() (base.py:2452)
2025-09-04 12:47:30,120 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b415d42ba91b43bd9bda68f5dfc53920 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'trail_trekker' AND table_schema = 'default__dev') AND table_name IN ('raw_subscriptions') (base.py:2452)
2025-09-04 12:47:30,122 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b415d42ba91b43bd9bda68f5dfc53920 */ CREATE OR REPLACE VIEW "default__dev"."raw_subscriptions" AS SELECT * FROM "sqlmesh__default"."raw_subscriptions__1243030195" (base.py:2452)
2025-09-04 12:47:30,123 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'default__dev.staging_customers' to point at table 'sqlmesh__default.staging_customers__3937340300' (evaluator.py:1694)
2025-09-04 12:47:30,123 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b415d42ba91b43bd9bda68f5dfc53920 */ SELECT CURRENT_CATALOG() (base.py:2452)
2025-09-04 12:47:30,123 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b415d42ba91b43bd9bda68f5dfc53920 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'trail_trekker' AND table_schema = 'default__dev') AND table_name IN ('staging_customers') (base.py:2452)
2025-09-04 12:47:30,125 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b415d42ba91b43bd9bda68f5dfc53920 */ CREATE OR REPLACE VIEW "default__dev"."staging_customers" AS SELECT * FROM "sqlmesh__default"."staging_customers__3937340300" (base.py:2452)
2025-09-04 12:47:30,126 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'default__dev.staging_features' to point at table 'sqlmesh__default.staging_features__2301256321' (evaluator.py:1694)
2025-09-04 12:47:30,126 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b415d42ba91b43bd9bda68f5dfc53920 */ SELECT CURRENT_CATALOG() (base.py:2452)
2025-09-04 12:47:30,126 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b415d42ba91b43bd9bda68f5dfc53920 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'trail_trekker' AND table_schema = 'default__dev') AND table_name IN ('staging_features') (base.py:2452)
2025-09-04 12:47:30,128 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b415d42ba91b43bd9bda68f5dfc53920 */ CREATE OR REPLACE VIEW "default__dev"."staging_features" AS SELECT * FROM "sqlmesh__default"."staging_features__2301256321" (base.py:2452)
2025-09-04 12:47:30,129 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'default__dev.staging_plans' to point at table 'sqlmesh__default.staging_plans__223612256' (evaluator.py:1694)
2025-09-04 12:47:30,129 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b415d42ba91b43bd9bda68f5dfc53920 */ SELECT CURRENT_CATALOG() (base.py:2452)
2025-09-04 12:47:30,129 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b415d42ba91b43bd9bda68f5dfc53920 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'trail_trekker' AND table_schema = 'default__dev') AND table_name IN ('staging_plans') (base.py:2452)
2025-09-04 12:47:30,131 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b415d42ba91b43bd9bda68f5dfc53920 */ CREATE OR REPLACE VIEW "default__dev"."staging_plans" AS SELECT * FROM "sqlmesh__default"."staging_plans__223612256" (base.py:2452)
2025-09-04 12:47:30,132 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'default__dev.staging_subscriptions' to point at table 'sqlmesh__default.staging_subscriptions__3522423559' (evaluator.py:1694)
2025-09-04 12:47:30,132 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b415d42ba91b43bd9bda68f5dfc53920 */ SELECT CURRENT_CATALOG() (base.py:2452)
2025-09-04 12:47:30,132 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b415d42ba91b43bd9bda68f5dfc53920 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'trail_trekker' AND table_schema = 'default__dev') AND table_name IN ('staging_subscriptions') (base.py:2452)
2025-09-04 12:47:30,134 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b415d42ba91b43bd9bda68f5dfc53920 */ CREATE OR REPLACE VIEW "default__dev"."staging_subscriptions" AS SELECT * FROM "sqlmesh__default"."staging_subscriptions__3522423559" (base.py:2452)
2025-09-04 12:47:30,134 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'default__dev.fct_subscription_changes' to point at table 'sqlmesh__default.fct_subscription_changes__2613690352' (evaluator.py:1694)
2025-09-04 12:47:30,135 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b415d42ba91b43bd9bda68f5dfc53920 */ SELECT CURRENT_CATALOG() (base.py:2452)
2025-09-04 12:47:30,135 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b415d42ba91b43bd9bda68f5dfc53920 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'trail_trekker' AND table_schema = 'default__dev') AND table_name IN ('fct_subscription_changes') (base.py:2452)
2025-09-04 12:47:30,137 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b415d42ba91b43bd9bda68f5dfc53920 */ CREATE OR REPLACE VIEW "default__dev"."fct_subscription_changes" AS SELECT * FROM "sqlmesh__default"."fct_subscription_changes__2613690352" (base.py:2452)
2025-09-04 12:47:30,138 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage FinalizeEnvironmentStage (evaluator.py:125)
2025-09-04 12:47:30,138 - MainThread - sqlmesh.core.state_sync.db.environment - INFO - Finalizing environment 'dev' (environment.py:141)
2025-09-04 12:47:30,146 - MainThread - root - INFO - Shutting down the event dispatcher (dispatcher.py:159)
