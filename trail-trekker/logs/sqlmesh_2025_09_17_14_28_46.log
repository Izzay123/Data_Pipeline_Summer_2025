2025-09-17 14:28:46,863 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for data files: {'../trail_trekker.db'} (connection.py:491)
2025-09-17 14:28:46,894 - MainThread - sqlmesh.core.config.connection - INFO - Using existing DuckDB adapter due to overlapping data file: ../trail_trekker.db (connection.py:481)
2025-09-17 14:28:46,901 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Compacting 0 intervals for 0 snapshots (interval.py:129)
2025-09-17 14:28:46,946 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema sqlmesh__default (evaluator.py:1477)
2025-09-17 14:28:46,946 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:2498)
2025-09-17 14:28:46,946 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'trail_trekker' AND table_schema = 'sqlmesh__default') AND table_name IN ('staging_customers__3937340300', 'staging_subscriptions__3522423559', 'fct_subscription_changes__2613690352', 'staging_plans__223612256', 'staging_features__2301256321') (base.py:2498)
2025-09-17 14:28:46,953 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"staging_customers": 615616541> (evaluator.py:700)
2025-09-17 14:28:46,953 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting data for snapshot SnapshotId<"staging_customers": 615616541> (evaluator.py:909)
2025-09-17 14:28:46,957 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2025-09-16 00:00:00, 2025-09-17 00:00:00) into sqlmesh__default.staging_customers__3937340300' (evaluator.py:939)
2025-09-17 14:28:46,957 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DESCRIBE "sqlmesh__default"."staging_customers__3937340300" (base.py:2498)
2025-09-17 14:28:46,958 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Replacing view 'sqlmesh__default.staging_customers__3937340300' (evaluator.py:2341)
2025-09-17 14:28:46,958 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:2498)
2025-09-17 14:28:46,958 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'trail_trekker' AND table_schema = 'sqlmesh__default') AND table_name IN ('staging_customers__3937340300') (base.py:2498)
2025-09-17 14:28:46,960 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW "sqlmesh__default"."staging_customers__3937340300" ("customer_id", "username", "email", "phone", "first_name", "last_name", "date_of_birth", "preferred_difficulty", "location_city", "location_state", "location_country", "profile_created_date", "total_hikes_logged", "favorite_trail_type") AS SELECT "raw_customers"."customer_id" AS "customer_id", "raw_customers"."username" AS "username", "raw_customers"."email" AS "email", COALESCE("raw_customers"."phone", '000-0000') AS "phone", "raw_customers"."first_name" AS "first_name", "raw_customers"."last_name" AS "last_name", COALESCE(TRY_CAST("raw_customers"."date_of_birth" AS DATE), CAST('1900-01-01' AS DATE)) AS "date_of_birth", "raw_customers"."preferred_difficulty" AS "preferred_difficulty", "raw_customers"."location_city" AS "location_city", "raw_customers"."location_state" AS "location_state", "raw_customers"."location_country" AS "location_country", COALESCE(TRY_CAST("raw_customers"."profile_created_date" AS DATE), CAST('1900-01-01' AS DATE)) AS "profile_created_date", COALESCE(TRY_CAST("raw_customers"."total_hikes_logged" AS INT), 0) AS "total_hikes_logged", "raw_customers"."favorite_trail_type" AS "favorite_trail_type" FROM "sqlmesh__default"."raw_customers__3189645474" AS "raw_customers" (base.py:2498)
2025-09-17 14:28:46,961 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Auditing snapshot SnapshotId<"staging_customers": 615616541> (evaluator.py:592)
2025-09-17 14:28:46,962 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DESCRIBE "sqlmesh__default"."staging_customers__3937340300" (base.py:2498)
2025-09-17 14:28:46,965 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT COUNT(*) FROM (SELECT * FROM "trail_trekker"."sqlmesh__default"."staging_customers__3937340300" AS "staging_customers__3937340300" WHERE "customer_id" IS NULL AND TRUE) AS "audit" (base.py:2498)
2025-09-17 14:28:46,965 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Adding interval (2025-09-16 00:00:00, 2025-09-17 00:00:00) for snapshot SnapshotId<"staging_customers": 615616541> (facade.py:623)
2025-09-17 14:28:46,965 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"staging_customers": 615616541> (interval.py:214)
2025-09-17 14:28:46,969 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"staging_features": 2289010702> (evaluator.py:700)
2025-09-17 14:28:46,969 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting data for snapshot SnapshotId<"staging_features": 2289010702> (evaluator.py:909)
2025-09-17 14:28:46,970 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2025-09-16 00:00:00, 2025-09-17 00:00:00) into sqlmesh__default.staging_features__2301256321' (evaluator.py:939)
2025-09-17 14:28:46,971 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DESCRIBE "sqlmesh__default"."staging_features__2301256321" (base.py:2498)
2025-09-17 14:28:46,971 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Replacing view 'sqlmesh__default.staging_features__2301256321' (evaluator.py:2341)
2025-09-17 14:28:46,971 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:2498)
2025-09-17 14:28:46,971 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'trail_trekker' AND table_schema = 'sqlmesh__default') AND table_name IN ('staging_features__2301256321') (base.py:2498)
2025-09-17 14:28:46,973 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW "sqlmesh__default"."staging_features__2301256321" ("feature_id", "feature_name", "feature_description", "feature_category") AS SELECT "raw_features"."feature_id" AS "feature_id", "raw_features"."feature_name" AS "feature_name", "raw_features"."feature_description" AS "feature_description", "raw_features"."feature_category" AS "feature_category" FROM "sqlmesh__default"."raw_features__8593745" AS "raw_features" (base.py:2498)
2025-09-17 14:28:46,973 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Auditing snapshot SnapshotId<"staging_features": 2289010702> (evaluator.py:592)
2025-09-17 14:28:46,973 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DESCRIBE "sqlmesh__default"."staging_features__2301256321" (base.py:2498)
2025-09-17 14:28:46,975 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT COUNT(*) FROM (SELECT * FROM "trail_trekker"."sqlmesh__default"."staging_features__2301256321" AS "staging_features__2301256321" WHERE "feature_id" IS NULL AND TRUE) AS "audit" (base.py:2498)
2025-09-17 14:28:46,976 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Adding interval (2025-09-16 00:00:00, 2025-09-17 00:00:00) for snapshot SnapshotId<"staging_features": 2289010702> (facade.py:623)
2025-09-17 14:28:46,976 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"staging_features": 2289010702> (interval.py:214)
2025-09-17 14:28:46,979 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"staging_plans": 3983633329> (evaluator.py:700)
2025-09-17 14:28:46,979 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting data for snapshot SnapshotId<"staging_plans": 3983633329> (evaluator.py:909)
2025-09-17 14:28:46,981 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2025-09-16 00:00:00, 2025-09-17 00:00:00) into sqlmesh__default.staging_plans__223612256' (evaluator.py:939)
2025-09-17 14:28:46,981 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DESCRIBE "sqlmesh__default"."staging_plans__223612256" (base.py:2498)
2025-09-17 14:28:46,982 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Replacing view 'sqlmesh__default.staging_plans__223612256' (evaluator.py:2341)
2025-09-17 14:28:46,982 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:2498)
2025-09-17 14:28:46,982 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'trail_trekker' AND table_schema = 'sqlmesh__default') AND table_name IN ('staging_plans__223612256') (base.py:2498)
2025-09-17 14:28:46,984 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW "sqlmesh__default"."staging_plans__223612256" ("plan_id", "plan_name", "plan_level", "price", "max_hikes_per_month", "photo_storage_gb", "description", "created_at") AS SELECT "raw_plans"."plan_id" AS "plan_id", "raw_plans"."plan_name" AS "plan_name", COALESCE(TRY_CAST("raw_plans"."plan_level" AS INT), 0) AS "plan_level", COALESCE(TRY_CAST("raw_plans"."price" AS DOUBLE), 0.0) AS "price", COALESCE(TRY_CAST("raw_plans"."max_hikes_per_month" AS INT), 0) AS "max_hikes_per_month", COALESCE(TRY_CAST("raw_plans"."photo_storage_gb" AS INT), 0) AS "photo_storage_gb", "raw_plans"."description" AS "description", COALESCE(TRY_CAST("raw_plans"."created_at" AS DATE), CAST('1900-01-01' AS DATE)) AS "created_at" FROM "sqlmesh__default"."raw_plans__3266981680" AS "raw_plans" (base.py:2498)
2025-09-17 14:28:46,984 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Adding interval (2025-09-16 00:00:00, 2025-09-17 00:00:00) for snapshot SnapshotId<"staging_plans": 3983633329> (facade.py:623)
2025-09-17 14:28:46,985 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"staging_plans": 3983633329> (interval.py:214)
2025-09-17 14:28:46,988 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"staging_subscriptions": 1166941588> (evaluator.py:700)
2025-09-17 14:28:46,988 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting data for snapshot SnapshotId<"staging_subscriptions": 1166941588> (evaluator.py:909)
2025-09-17 14:28:46,990 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2025-09-16 00:00:00, 2025-09-17 00:00:00) into sqlmesh__default.staging_subscriptions__3522423559' (evaluator.py:939)
2025-09-17 14:28:46,990 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DESCRIBE "sqlmesh__default"."staging_subscriptions__3522423559" (base.py:2498)
2025-09-17 14:28:46,990 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Replacing view 'sqlmesh__default.staging_subscriptions__3522423559' (evaluator.py:2341)
2025-09-17 14:28:46,990 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:2498)
2025-09-17 14:28:46,992 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'trail_trekker' AND table_schema = 'sqlmesh__default') AND table_name IN ('staging_subscriptions__3522423559') (base.py:2498)
2025-09-17 14:28:46,994 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW "sqlmesh__default"."staging_subscriptions__3522423559" ("subscription_id", "customer_id", "plan_id", "billing_cycle", "subscription_start_date", "subscription_end_date", "status", "next_billing_date", "payment_method") AS SELECT "raw_subscriptions"."subscription_id" AS "subscription_id", "raw_subscriptions"."customer_id" AS "customer_id", "raw_subscriptions"."plan_id" AS "plan_id", "raw_subscriptions"."billing_cycle" AS "billing_cycle", "raw_subscriptions"."subscription_start_date" AS "subscription_start_date", COALESCE(TRY_CAST("raw_subscriptions"."subscription_end_date" AS DATE), CAST('1900-01-01' AS DATE)) AS "subscription_end_date", "raw_subscriptions"."status" AS "status", COALESCE(TRY_CAST("raw_subscriptions"."next_billing_date" AS DATE), CAST('1900-01-01' AS DATE)) AS "next_billing_date", "raw_subscriptions"."payment_method" AS "payment_method" FROM "sqlmesh__default"."raw_subscriptions__1243030195" AS "raw_subscriptions" (base.py:2498)
2025-09-17 14:28:46,994 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Auditing snapshot SnapshotId<"staging_subscriptions": 1166941588> (evaluator.py:592)
2025-09-17 14:28:46,994 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DESCRIBE "sqlmesh__default"."staging_subscriptions__3522423559" (base.py:2498)
2025-09-17 14:28:46,996 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT COUNT(*) FROM (SELECT * FROM "trail_trekker"."sqlmesh__default"."staging_subscriptions__3522423559" AS "staging_subscriptions__3522423559" WHERE ("subscription_id" IS NULL OR "customer_id" IS NULL OR "plan_id" IS NULL) AND TRUE) AS "audit" (base.py:2498)
2025-09-17 14:28:46,996 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Adding interval (2025-09-16 00:00:00, 2025-09-17 00:00:00) for snapshot SnapshotId<"staging_subscriptions": 1166941588> (facade.py:623)
2025-09-17 14:28:46,996 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"staging_subscriptions": 1166941588> (interval.py:214)
2025-09-17 14:28:46,999 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"fct_subscription_changes": 4270684332> (evaluator.py:700)
2025-09-17 14:28:46,999 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting data for snapshot SnapshotId<"fct_subscription_changes": 4270684332> (evaluator.py:909)
2025-09-17 14:28:47,001 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2025-09-16 00:00:00, 2025-09-17 00:00:00) into sqlmesh__default.fct_subscription_changes__2613690352' (evaluator.py:939)
2025-09-17 14:28:47,001 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DESCRIBE "sqlmesh__default"."fct_subscription_changes__2613690352" (base.py:2498)
2025-09-17 14:28:47,001 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Replacing view 'sqlmesh__default.fct_subscription_changes__2613690352' (evaluator.py:2341)
2025-09-17 14:28:47,002 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:2498)
2025-09-17 14:28:47,002 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'trail_trekker' AND table_schema = 'sqlmesh__default') AND table_name IN ('fct_subscription_changes__2613690352') (base.py:2498)
2025-09-17 14:28:47,004 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW "sqlmesh__default"."fct_subscription_changes__2613690352" ("customer_id", "subscription_id", "current_plan_id", "subscription_start_date", "subscription_end_date") AS SELECT "staging_subscriptions"."customer_id" AS "customer_id", "staging_subscriptions"."subscription_id" AS "subscription_id", "staging_subscriptions"."plan_id" AS "current_plan_id", "staging_subscriptions"."subscription_start_date" AS "subscription_start_date", "staging_subscriptions"."subscription_end_date" AS "subscription_end_date" FROM "sqlmesh__default"."staging_subscriptions__3522423559" AS "staging_subscriptions" ORDER BY "customer_id", "subscription_id", "subscription_start_date" DESC (base.py:2498)
2025-09-17 14:28:47,004 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Auditing snapshot SnapshotId<"fct_subscription_changes": 4270684332> (evaluator.py:592)
2025-09-17 14:28:47,004 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DESCRIBE "sqlmesh__default"."fct_subscription_changes__2613690352" (base.py:2498)
2025-09-17 14:28:47,006 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT COUNT(*) FROM (SELECT * FROM "trail_trekker"."sqlmesh__default"."fct_subscription_changes__2613690352" AS "fct_subscription_changes__2613690352" WHERE ("subscription_id" IS NULL OR "customer_id" IS NULL) AND TRUE) AS "audit" (base.py:2498)
2025-09-17 14:28:47,006 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Adding interval (2025-09-16 00:00:00, 2025-09-17 00:00:00) for snapshot SnapshotId<"fct_subscription_changes": 4270684332> (facade.py:623)
2025-09-17 14:28:47,007 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"fct_subscription_changes": 4270684332> (interval.py:214)
2025-09-17 14:28:47,026 - MainThread - root - INFO - Shutting down the event dispatcher (dispatcher.py:159)
